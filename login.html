<!doctype html>
<html lang="en">

<head>
	<title>Login - BikeRent Pro</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

	<!-- Custom CSS -->
	<link rel="stylesheet" href="css/style.css">

	<script>
        var accessToken = localStorage.getItem("access_token");
        if (accessToken != null) {
            window.location.href = "index.html";
        }
    </script>
</head>

<body class="login-page">
	<!-- Page Loader -->
	<div class="page-loader">
		<div class="loader-spinner"></div>
	</div>

	<section class="min-vh-100 d-flex align-items-center">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-lg-10 col-xl-9">
					<div class="card border-0 auth-card overflow-hidden">
						<div class="row g-0">
							<!-- Left Side - Image -->
							<div class="col-lg-6 d-none d-lg-block auth-image-side">
								<img src="images/bg-1.jpg" alt="BikeRent Pro">
								<div class="auth-content d-flex flex-column justify-content-center h-100">
									<div class="mb-4">
										<img src="images/bike6.jpg" alt="BikeRent Pro" class="auth-logo">
									</div>
									<h2 class="mb-3 fw-bold">Welcome Back!</h2>
									<p class="lead mb-4">Ready for your next adventure? Sign in to access our premium motorcycle fleet and start your journey today.</p>
									<div class="auth-features">
										<div class="auth-feature">
											<i class="fas fa-motorcycle me-3 fa-lg"></i>
											<span class="fw-medium">150+ Premium Bikes</span>
										</div>
										<div class="auth-feature">
											<i class="fas fa-shield-alt me-3 fa-lg"></i>
											<span class="fw-medium">Fully Insured & Safe</span>
										</div>
										<div class="auth-feature">
											<i class="fas fa-headset me-3 fa-lg"></i>
											<span class="fw-medium">24/7 Customer Support</span>
										</div>
									</div>
								</div>
							</div>

							<!-- Right Side - Login Form -->
							<div class="col-lg-6">
								<div class="p-5">
									<div class="text-center mb-5">
										<h3 class="fw-bold text-primary mb-2">Sign In</h3>
										<p class="text-muted">Access your BikeRent Pro account and start your adventure</p>
									</div>

									<!-- Social Login -->
									<div class="d-flex gap-3 mb-4">
										<button type="button" class="btn social-btn facebook flex-fill">
											<i class="fab fa-facebook-f me-2"></i>Facebook
										</button>
										<button type="button" class="btn social-btn google flex-fill">
											<i class="fab fa-google me-2"></i>Google
										</button>
									</div>

									<div class="text-center mb-4">
										<div class="position-relative">
											<hr class="my-4">
											<span class="position-absolute top-50 start-50 translate-middle bg-white px-3 text-muted">
												or sign in with email
											</span>
										</div>
									</div>

									<form class="auth-form" onsubmit="return submitHandle()" action="index.html">
										<div class="form-floating input-animated">
											<input type="text" class="form-control" id="email" placeholder="Email or Username"
												   onblur="emailValidation()" required>
											<label for="email">Email or Username</label>
											<div class="invalid-feedback">
												Please enter a valid email or username.
											</div>
										</div>

										<div class="form-floating input-animated position-relative">
											<input type="password" class="form-control" id="password-field" placeholder="Password"
												   onblur="passValidation()" required>
											<label for="password-field">Password</label>
											<button type="button" class="btn btn-link position-absolute top-50 end-0 translate-middle-y pe-3 border-0 bg-transparent toggle-password"
													toggle="#password-field" style="z-index: 10;">
												<i class="fas fa-eye text-muted"></i>
											</button>
											<div class="invalid-feedback">
												Please enter your password (minimum 6 characters).
											</div>
										</div>

										<div class="d-flex justify-content-between align-items-center mb-4">
											<div class="form-check">
												<input class="form-check-input" type="checkbox" id="rememberMe" checked>
												<label class="form-check-label" for="rememberMe">
													Remember me
												</label>
											</div>
											<a href="#" class="text-decoration-none">Forgot Password?</a>
										</div>

										<button type="submit" class="auth-btn w-100 mb-4">
											<i class="fas fa-sign-in-alt me-2"></i>Sign In to Your Account
										</button>
									</form>

									<div class="text-center">
										<p class="mb-2">Don't have an account?
											<a href="acount.html" class="text-decoration-none fw-medium">Create Account</a>
										</p>
										<div class="mt-3 p-3 bg-light rounded">
											<small class="text-muted">
												<i class="fas fa-info-circle me-1"></i>
												<strong>Demo Login:</strong> Use "admin" / "password" or your registered email/name
											</small>
										</div>
									</div>

									<!-- Security Features -->
									<div class="security-features">
										<div class="row text-center">
											<div class="col-4">
												<div class="security-feature">
													<i class="fas fa-lock text-success"></i>
													<small class="d-block text-muted fw-medium">Secure Login</small>
												</div>
											</div>
											<div class="col-4">
												<div class="security-feature">
													<i class="fas fa-bolt text-warning"></i>
													<small class="d-block text-muted fw-medium">Fast Access</small>
												</div>
											</div>
											<div class="col-4">
												<div class="security-feature">
													<i class="fas fa-heart text-danger"></i>
													<small class="d-block text-muted fw-medium">Trusted Platform</small>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>

	<!-- Custom JS -->
	<script src="js/main.js"></script>

</body>

<script>
	// Enhanced form validation with visual feedback
	function emailValidation() {
		var email = $("#email").val().trim();
		var $emailField = $("#email");

		// Simple email validation for login
		var emailReg = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;
		var usernameReg = /^[A-Za-z\s]{2,50}$/; // Allow names with spaces

		if (email === "") {
			$emailField.removeClass('is-valid').addClass('is-invalid');
			return false;
		}
		// Accept either email format or simple username/full name
		else if (!emailReg.test(email) && !usernameReg.test(email) && email.length < 2) {
			$emailField.removeClass('is-valid').addClass('is-invalid');
			return false;
		}
		else {
			$emailField.removeClass('is-invalid').addClass('is-valid');
			return true;
		}
	}

	function passValidation() {
		var pass = $("#password-field").val();
		var $passField = $("#password-field");

		if (pass === "") {
			$passField.removeClass('is-valid').addClass('is-invalid');
			return false;
		}
		else if (pass.length < 6) {
			$passField.removeClass('is-valid').addClass('is-invalid');
			return false;
		}
		else {
			$passField.removeClass('is-invalid').addClass('is-valid');
			return true;
		}
	}

	function submitHandle() {
		var emailRes = emailValidation();
		var passRes = passValidation();

		if (emailRes && passRes) {
			var inputEmail = $("#email").val().trim();
			var inputPass = $("#password-field").val();

			// Check if user data exists in localStorage
			var userData = localStorage.getItem("user_data");
			var isValidUser = false;

			if (userData) {
				try {
					var user = JSON.parse(userData);
					// Check if login matches registered user (email or full name)
					if ((user.email === inputEmail || user.fullName === inputEmail) && inputPass.length >= 6) {
						isValidUser = true;
					}
				} catch (e) {
					console.log("Error parsing user data");
				}
			}

			// For demo purposes, also allow default credentials
			if (!isValidUser && (inputEmail === "admin" || inputEmail === "demo@bikerent.com") && inputPass === "password") {
				isValidUser = true;
			}

			if (isValidUser) {
				// Create access token
				var encodedString = btoa(inputEmail + " " + inputPass);
				localStorage.setItem("access_token", encodedString);

				// Show success message
				showNotification("Login successful! Welcome back!", "success");

				// Add loading state to button
				var $submitBtn = $('button[type="submit"]');
				$submitBtn.html('<i class="fas fa-spinner fa-spin me-2"></i>Signing In...');
				$submitBtn.prop('disabled', true);

				// Redirect after a short delay
				setTimeout(() => {
					window.location.href = "index.html";
				}, 1500);

				return false; // Prevent form submission
			} else {
				showNotification("Invalid credentials. Please check your email/username and password.", "error");
				return false;
			}
		}

		showNotification("Please fill in all fields correctly.", "error");
		return false;
	}

	// Show notification function
	function showNotification(message, type) {
		const alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
		const icon = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';

		const notification = `
			<div class="alert ${alertClass} alert-dismissible fade show position-fixed top-0 start-50 translate-middle-x mt-3"
				 style="z-index: 9999; min-width: 300px;" role="alert">
				<i class="${icon} me-2"></i>${message}
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>
		`;

		$('body').append(notification);

		// Auto remove after 3 seconds
		setTimeout(() => {
			$('.alert').alert('close');
		}, 3000);
	}

	// Enhanced password toggle
	$(".toggle-password").click(function() {
		const $icon = $(this).find('i');
		const $input = $($(this).attr("toggle"));

		if ($input.attr("type") === "password") {
			$input.attr("type", "text");
			$icon.removeClass("fa-eye").addClass("fa-eye-slash");
		} else {
			$input.attr("type", "password");
			$icon.removeClass("fa-eye-slash").addClass("fa-eye");
		}
	});

	// Add floating label animation
	$(document).ready(function() {
		$('.form-floating input').on('focus blur', function() {
			$(this).closest('.form-floating').toggleClass('focused');
		});
	});
</script>

</html>